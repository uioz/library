# 标题: 移动端布局基础概念指南

我没有移动端开发经验, 但是我对移动端的页面的布局很感兴趣, 在过去的几个月的时间里我浏览了一些有关移动端布局的文章.  
不过即使花了我十几个小时的阅读, 我依然是一头雾水.  
在一本比较旧的讲解响应式的书中我看到了这一句话:

> 这是因为 iOS 上的 Safari浏览器默认是在980像素宽的画布上渲染页面，然后将画布缩小到与视口大小匹配。 虽然得放大页面才能看清楚，但页面内容没有被切掉。

结合之前我浏览过的文章这些内容忽然被串联了起来, 这篇文章就是我对**响应式以及移动布局**基础的一些思考和总结.  
如果你想了解移动端布局的基本概念, 这篇文章将会非常适合你.  

# 移动端浏览器如何渲染为桌面设计的页面

为了简单起见, 我们不从概念讲起, 我们先来看看一个固定宽度的元素被放置到移动端浏览器中会发生什么.

有如下代码:
```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <style>
    .example{
      width: 900px;
      background-color: aqua;
    }
  </style>
</head>
<body>
  <div class="example">
    我的宽度是 900px
  </div>
</body>
</html>
```

当然桌面浏览器渲染效果肯定在我们意料之中啦✨:

**图片**: 1920px下chrome渲染的效果:

![批注 2019-07-18 165112](C:\Users\zhao\Documents\library\article\assets\移动端布局基础概念指南\批注 2019-07-18 165112.png)

而下面展示了图片展示了几个移动端浏览器渲染的结果:

**图片**: 移动端浏览器渲染效果:

![1563439703821](C:\Users\zhao\Documents\library\article\assets\移动端布局基础概念指南\1563439703821.jpg)

这里我们简单的介绍一下图片中浏览器的版本, 这些浏览器在后文的截图中版本都是不会发生变化的.

| 浏览器  | 版本 | 平台      |
| ------- | ---- | --------- |
| chrome  | 75   | windows10 |
| chrome  | 75   | android9  |
| edge    | 42   | android9  |
| Samsung | 9.3  | android9  |

仔细观察我们发现:**900px 宽的 div 没有占满屏幕, 也就是说屏幕的宽度比 900px 还要大.**  
那么屏幕宽度到底是多大呢, 我们插入一行代码来获取屏幕的宽度:

```html
<script>
  document.write(`html元素的宽度是${document.documentElement.clientWidth}`);
</script>
```

不同浏览器的显示结果为:

![1563441464510](C:\Users\zhao\Documents\library\article\assets\移动端布局基础概念指南\1563441464510.jpg)

他们都输出了同样的数据那就是 980 在某种程度上我们知道了页面的宽度, 原来页面是 980px 的宽度所以 900px 的div无法铺满一行.  

我们来慢慢分析:

首先页面的宽度的确是 980像素在这种情况下渲染的页面的比例是和一个拥有 980px 宽度的显示器渲染出的比例是一致的. 
在没有使用其他影响页面设置的情况下(后文会讲), 这种情况基本可以理解为移动端浏览器按照 980px 的宽度来渲染页面, 然后再将页面缩放到适合屏幕的大小.

不理解没关系, 我们使用一张图来理解这一行为:

![1563443177628](C:\Users\zhao\Documents\library\article\assets\移动端布局基础概念指南\1563443177628.jpg)

为什么会有这种行为?

原因很简单, 在移动设备刚刚兴起的时候大多数的页面都是为桌面设计的在当时一个页面的内容区域的宽度一般在 980px 以内.

但是移动设备屏幕的分辨率很小, 某款手机的屏幕的横向分辨率是 320px 完全不足以容纳为桌面设计的页面.

和现在的情况相反, 手机厂商得设计一种方式来兼容现有的页面确保页面在移动端布局正常, 所以手机浏览器的默认内容区域的宽度被设置为桌面页面内容区域的典型值 980px(不同设备不同,后面有统一方法), 为了浏览效果和桌面一致将内容区域平铺到屏幕上. 

这样确保了布局正常且手机屏幕上浏览的整体效果和在桌面上的一致, 不过说到底移动端的横向分辨率只有 320px 自然有些内容看不清楚这个时候怎么办呢 -> 双击缩放呗🤣.

# 默认渲染方式导致的问题

回想一下移动端浏览器的两个默认的渲染行为:
1. 页面内容区域大小为 980px
2. 将页面区域按照比例缩放到屏幕的大小

对于响应式设计来说, 这种默认的行为有些问题. 例如第一种行为会导致低于 980px 的媒体查询没有效果, 因为移动端页面宽度只有 980px.

```html
<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <style>
    .example {
      width: 900px;
      background-color: aqua;
    }

    @media screen and (max-width:960px) {
      .example {
        background-color: red;
      }
    }
  </style>
</head>

<body>
  <div class="example">
    我的宽度是 900px
  </div>
  <script>
    document.write(`html元素的宽度是${document.documentElement.clientWidth}`);
  </script>
</body>

</html>
```

所以一个自然的想法就产生了页面的大小应该和屏幕大小一致才对啊, 这样我们就可以处理不同宽度的设备了.

## 初探 viewport 属性

想要实现我们之前的想法, 我需要使用 `<meta name="viewport" content="">` 这个标签来实现.

这个标签相信很多人都不陌生, 在大部分的IDE和文本编辑器中这行代码被放到了创建HTML文件的模板里.

```html
<meta name="viewport" content="width=device-width, initial-scale=1.0">
```

为了更好的理解这些属性我们先看使用后的结果, 在随后的章节中我们在详细的讨论 `viewport` 的具体使用方式.

不过在此之前这行代码的基本作用是 "调整视口宽度和设备宽度一致".

**图片**:适应设备宽度后的渲染效果:

![1563458168665](C:\Users\zhao\Documents\library\article\assets\移动端布局基础概念指南\1563458168665.jpg)

**注意**:上面图片中的三个浏览器实际上都是有横向滚动条, 可以通过横向滚动来浏览全部的内容, 如果你的页面最小区域是 1200px 或者 1400px 那么在移动端就需要横向滚动才可以浏览完成, 前提是添加了上文提到的 meta 标签.

页面中的内容显得更加大了一些, 除此以外看起来也没太大变化嘛. 不过这个手机看起来分辨率挺低的啊 html元素宽度居然是 412px , 这个年头的老人机横向分辨率都比这个高了吧!

是的 HTML元素宽度确实是 412px , 但是我的手机的横向分辨率却是 1440px, 看来我们又有了一个新的问题, 不过好在下一章中我们就可以解开这个谜团了.

# `css`像素与物理像素

`css` 中的 `px` 单位也就是我们常说的 "像素" 和显示器屏幕这个物理设备上提到的 "像素" 不是同一个东西, 也就是说 "`css` 中的像素" 不等于 "屏幕像素", 或者说 "`css` 中的像素" 和屏幕上的这种物理像素不是同一个概念.

`css` 中的像素是一个相对单位, 而对立的绝对单位就是屏幕上的物理像素啦.

虽然听起来很奇怪因为在桌面端1像素它就是1像素啊🤷‍♂️, 为什么说它是相对单位呢?

因为大部分情况下桌面操作系统中设定的屏幕分辨率和显示器的物理分辨率都是一致的, 所以就会造成 "css 中的像素" 和 屏幕上的像素是同一个概念的误会.

不过证明 "`css` 中的像素" 不等于 "屏幕像素" 也很简单, 在我刚刚使用搭载 `windows10` 操作系统的笔记本的时候, 我发现了一个问题我的 1080p 分辨率的屏幕在运行浏览器时测得 HTML元素的宽度居然是 1536px 而更加神奇的是 edge 和 ie 浏览器测得的数据都是 1920px:

**图片**:chrome和firefox的 HTML 元素的宽度:

![1563459939233](C:\Users\zhao\Documents\library\article\assets\移动端布局基础概念指南\1563459939233.png)

**注意**:因为写作的途中换了设备新的设备系统也不一致, 原有的 edge 和 ie 的表现无法再次展示, 不过不排除是我手动修改了某些配置所造成的情况, 但是不影响说明问题.

**注意**:后文中我们用 **css像素** 和 **物理像素** 来指代上文中提到的 "像素" 单位.

这个问题困扰了我好久, 直到我注意到了 `windows10` 中的一个选项:

![批注 2019-07-18 222819](C:\Users\zhao\Documents\library\article\assets\移动端布局基础概念指南\批注 2019-07-18 222819.png)

因为所有的应用都都被放大了,而 `1536 * 1.25 = 1920` , 当我把这个设置调整到 100% 的时候所有的浏览器的 HTML元素的宽度都变成了 1920 像素.

而实际上还有一个更简单的证明方案, 就是缩放你的浏览器一旦缩放你的浏览器你的`css`像素就不会等于你的物理像素了.

## 那么 `css`像素 在移动端是什么情况

在现代的移动设备中的屏幕物理分辨率大部分都超过了 320px(物理像素), 实际上桌面显示器还在 1080p 的阶段, 移动设备的分辨率大部分都接近 2k 了, 所以这里会出现一个问题, **移动设备的屏幕太小如果一个`css`像素等于一个物理像素那么显示的东西会挤在一团文字小到看不清**. 所以终端厂商会在设备里面内置了一个 "适合的分辨率" 用于显示, 毫无疑问大部分的终端中这个 "适合的分辨率" 大部分都小于设备的 "物理分辨率" .

例如:我们有一个设备的横向物理像素数量是 1920, 某个终端制造商设置的内置值是 960, 那么我们就是用一个`css`像素来对应两个物理像素, 效果就是把显示的内容放大了一倍, 那么这个比值就是 1920 / 960 = 2 ,而这个值就是常说的**设备像素比**, 而 "适合显示的分辨率" 就是常说的 **设备像素**.

// TODO 查看设备像素比, 和查看设备像素

// TOOD 页面中输出更多内容

## css像素 与 物理像素

相应式中有许多单位名词, 例如本节标题上的内容不过为了简单起见本篇文章中不会使用这些名词.  

回顾一下刚才我提到了我的手机横向分辨率是 1080像素, 你可以返回查看之前的截图我们设置的

// TODO 修改为原生大小



讲解 屏幕缩放比例 与 css像素之间的关系

# 第三步
使用 viewport 的 初始缩放和device-width 来说明问题

# 第四步响应式设计

css像素会变化吗?

会变的只有设备的宽度

# 探讨缩放方案

> https://blog.csdn.net/rucwang/article/details/79050397
>
> https://www.cnblogs.com/yelongsan/p/7975580.html