词法环境是一种规范类型它定义标识符与基于ECMAScript代码的词法嵌套的变量与函数之间的关联.

词法环境由环境记录和一个可能为 null 的外部环境引用.

通常一个词法环境和具体的 ECMAScript 代码的语法结构相关, 例如 函数声明, 代码块, try 语句的 catch 块, 和每次代码被求值时所创建的词法环境.

一个环境记录记录了那些在对应的词法环境作用域所创建的标识符绑定. 它被称为词法环境的 "环境记录".

外部环境引用用于对词法环境中的值的逻辑嵌套进行建模. 内部词法环境的外部引用引用着逻辑上围绕着内部词法环境的外部词法环境. 当然, 外部词法环境也会拥有它的外部词法环境. 一个词法环境作为外部环境时可以作为多个内部环境的外部环境. 例如, 如果一个函数声明内部拥有两个嵌套的函数声明那么每一个嵌套函数的词法环境都将其外部词法环境作为当前对周围函数求值的词法环境. (太拗口了, 简单来说每一个嵌套函数的外部环境引用就是这个定义了两个函数的词法环境.)

全局词法环境是一种没有外部环境的词法环境. 也就是说全局词法环境的外部环境的引用时 null. 全局词法环境的环境记录可能被标识符绑定以及一个关联的全局对象该对象属性上提供了某些全局环境的标识符绑定所预填充. 当 ECMAScript 代码一旦执行, 额外的属性可能会被添加到全局对象上而最初的属性也可能会被修改.

模块的环境是一个包含模块的顶级声明的绑定的词法环境. 它同时也包含那些通过 import 导入的具体绑定. 模块环境的的外部环境是全局环境.

函数环境





