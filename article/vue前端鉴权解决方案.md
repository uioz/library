# 前言

前端鉴权是挺有意思的的话题, 我们都知道前端的鉴权就是障眼法而已, 大部分情况下只需要进行判断不显示某些东西就可以了.

但是鉴于现在的项目复杂度虽然直接使用 `if` 来屏蔽某些内容是一种简单可行的方案, 但是散落在代码各个角落中的 `if` 语句在成百上千个组件中将是维护者的噩梦.

那么有没有一种简单有效符合逻辑且可维护的方式呢, 这里记录了我探索的一种前端鉴权的方式(没准之前已经有人用过了).

**注意**:本文中介绍的内容大部分是经过实践的, 部分内容仅仅是设想没有经过测试, 这部分会特殊标注出来.

**注意**:适合才是最好的.

## 起手依赖

鉴权方式依赖 `vue-router` 的 `addRoute` 方法和 `vue` 自定义指令还有 `webpack` 的动态导入语法(可选) 以及 `vuex`(可选), 所以依赖至少得是如下的版本.

- 项目使用 `webpack2.6+` 打包
- 项目中使用 `vue2+` 和 `vue-router3+` 和 `vuex3+`

# 问题分析

我们先把要做的事情搞清楚一点, 不扯那些高深莫测的名词.

假设我们要做一个在线商城, 用于有两种主要的类型:

| 类型     | 解释                             |
| -------- | -------------------------------- |
| 普通用户 | 只能购买东西                     |
| 商家     | 不仅可以购买东西, 还可以上架东西 |

## 问题显现

基本分为两类:

| 个人分类     | 解释                                                         |
| ------------ | ------------------------------------------------------------ |
| 页面级过滤   | 普通用户无法进入上传物品页面                                 |
| 组件级别过滤 | 商品详情页面双方都可以浏览, 但是布局不同, 在商家的视角页面中可能多出一些操作按钮用于修改页面. |

当然没准在网络请求中也有过滤, 不过这点不在我们的讨论范围内.

# 基本解决方式

## 路由中

## 组件中

## 弊端

# 页面级鉴权方案

## 基本概念

## 初次实践

## 动态切换角色

### 角色冲突

## 复用组件而不是复用 URL

## 增量更新子路由

## 组件级鉴权方案